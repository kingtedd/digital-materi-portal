# App Flow Document for digital-materi-portal

## Onboarding and Sign-In/Sign-Up

When a new user arrives at the digital-materi-portal, they are greeted by the sign-in page, which also serves as the landing page. This page displays a prominent button inviting them to sign in with their Google account. If the user has not yet authorized the portal, clicking the button opens Google’s authentication window. The user selects their Google account, consents to any required permissions, and then the portal exchanges a token with the Laravel backend to establish a session. After that handshake, the portal fetches the user’s role information—teacher or admin—and redirects them to the appropriate dashboard. Signing out is just as straightforward: a “Sign Out” link in the header clears the session and returns the user to the sign-in page. Password recovery is not handled in the portal itself, because all accounts rely on Google OAuth for access. Any account changes to credentials are made directly through the user’s Google account settings.

## Main Dashboard or Home Page

Once signed in, the user lands on the dashboard, which is the central hub of the application. The page features a top navigation bar showing the portal logo on the left and the user’s display name with a sign-out control on the right. A vertical sidebar runs along the left side of the screen and lists the main sections: "Materials," "Analytics," "Jobs Monitor," and, for admins only, "User Management." Clicking any of these links updates the central content area without a full page reload, thanks to Next.js routing. The main dashboard view itself defaults to the Materials overview, displaying a table of existing material catalog entries. Above the table, there is a button labeled “Add New Material” that navigates to the material creation flow.

## Detailed Feature Flows and Page Transitions

When the user selects the “Materials” section, the portal fetches the material catalog from the Laravel API via a Next.js API route. The data displays in a responsive table with columns for subject name, material title, creation date, and current job status. From here, the teacher or admin can click on any table row to open a detail view, or click the “Add New Material” button to start the creation flow. The creation flow is a form built with shadcn/ui components. The user enters the subject, title, description, and any additional metadata. Upon submission, the form calls the Next.js backend-for-frontend API. That handler makes a secure server-to-server request to the Laravel API, which adds the row to Google Sheets, enqueues a job in the Laravel jobs table, and triggers the n8n workflow for content generation. The user is then redirected to the Job Monitor section with the new job’s identifier.

In the Analytics section, the portal requests the Gemini analysis results JSON from the Laravel API. Once received, the JSON is passed to a charting component that renders interactive graphs. Users can toggle between chart views, filter by date, or download CSV exports right from the charts toolbar. Any change in filters updates the visualization dynamically without leaving the page.

The Jobs Monitor section shows a list of pending and completed jobs. As soon as the user arrives on this page, a React Query hook begins polling the Laravel API for each job’s status. The interface updates each job’s progress indicator in real time. If a job fails, it is highlighted in red with a link to view failure details. Clicking on a job identifier opens a modal with logs and error messages returned from the backend.

If the user is an admin, the User Management page appears in the sidebar. This page lists all portal users fetched from the Laravel API. The admin can search by name or email, click on a user to view their details, edit the user’s display name or role, and deactivate or reactivate the account. All edits are sent through the BFF API, which ensures the Laravel backend processes updates and enforces access controls.

## Settings and Account Management

The portal includes a profile page accessible via the user avatar dropdown in the header. On this page, the user can update personal details such as display name and notification preferences. Any changes made here are submitted to the Laravel API and immediately reflected across the portal. Notifications are managed in a simple toggle interface that, when updated, calls the BFF route to adjust preferences in the backend. After saving settings, the user can click a link to return to the main dashboard or any of the core sections by using the sidebar links.

## Error States and Alternate Paths

If the user submits invalid data in any form—such as missing required fields or invalid formatting—the form displays inline error messages under each field and a summary alert at the top. When a network error occurs, a full-page banner appears explaining the connectivity issue and offering a retry button. If the user attempts to access a restricted page, like an admin-only section, the portal shows a 403-style access denied page with a link to return to the dashboard. Should the session expire, any API call returns a 401 status, triggering a redirect back to the sign-in page with a notice that the session has timed out.

## Conclusion and Overall App Journey

In summary, a user begins by signing in with Google, which immediately identifies their role. They land on a unified dashboard featuring material management, analytics, and job monitoring. Teachers primarily work in the Materials and Analytics sections, while admins can also manage users. The portal uses Next.js API routes as a secure proxy to the Laravel backend, ensuring data operations happen safely and cleanly. Throughout the journey, form validation, real-time job status updates, and clear error handling guide the user seamlessly from content creation to final analysis. This flow enables both teachers and administrators to efficiently manage digital materials, monitor workflows, and gain insights from the Gemini-powered analytics without ever leaving the portal.